<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Kingdom Calendar ‚Äì Path of Years</title>

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="favicon.png">

  <!-- Social Sharing Preview (Facebook, etc.) -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Kingdom Calendar ‚Äì Path of Years">
  <meta property="og:description" content="Track the Renewed Moon, Work Days, and Shabats according to the Path of Years.">
  <meta property="og:url" content="https://kingdomcalendartool.com/">
  <meta property="og:image" content="https://kingdomcalendartool.com/favicon.png">

  <style>
  body {
    background:#020617;
    color:#e5e7eb;
    font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
    margin:0;
    padding:8px;
    display:flex;
    justify-content:center;
  }

  .calendar { width:100%; max-width:850px; }

  .calendarHeader {
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:8px;
    margin-bottom:2px;
  }
  .calendarSide {
    width:150px;
    font-size:10px;
    text-transform:uppercase;
    letter-spacing:.16em;
    color:#9ca3af;
    white-space:nowrap;
  }
  .calendarRef { text-align:left; }

  .calendarTitle {
    flex:1;
    text-align:center;
    font-size:18px;
    font-weight:600;
    letter-spacing:.18em;
    text-transform:uppercase;
    color:#fef9c3;
  }

  .monthBadge {
    display:inline-block;
    font-size:10px;
    text-transform:uppercase;
    letter-spacing:.18em;
    padding:3px 9px;
    border-radius:999px;
    background:rgba(250,204,21,0.18);
    border:1px solid rgba(250,204,21,0.7);
    color:#facc15;
  }

  .calendarSub { font-size:11px; color:#9ca3af; text-align:center; margin-bottom:2px; }
  .calendarNote { font-size:10px; color:#9ca3af; text-align:center; margin-bottom:6px; }

  .configBar {
    background:#020617;
    border-radius:8px;
    border:1px solid #111827;
    padding:6px 8px;
    margin-bottom:8px;
    display:flex;
    flex-wrap:wrap;
    align-items:center;
    gap:6px;
    font-size:11px;
  }
  .configLabel { color:#e5e7eb; }
  .configBar input[type="date"],
  .configBar select {
    background:#020617;
    border:1px solid #1f2937;
    border-radius:6px;
    padding:3px 5px;
    color:#e5e7eb;
    font-size:11px;
  }
  .configHint { font-size:10px; color:#9ca3af; }

  .monthTools{
    max-width:700px;
    margin:0 auto 8px auto;
    display:flex;
    flex-direction:column;
    gap:6px;
  }
  .monthToggle{
    display:flex;
    align-items:center;
    justify-content:center;
    gap:10px;
    flex-wrap:wrap;
    background:#0b1120;
    border:1px solid #1f2937;
    border-radius:10px;
    padding:6px 10px;
    font-size:11px;
  }
  .monthToggleLabel{
    font-size:10px;
    text-transform:uppercase;
    letter-spacing:.16em;
    color:#9ca3af;
  }
  .monthRadio{
    display:flex;
    align-items:center;
    gap:7px;
    padding:4px 10px;
    border-radius:999px;
    border:1px solid rgba(250,204,21,0.35);
    background:rgba(250,204,21,0.06);
    cursor:pointer;
    user-select:none;
  }
  .monthRadio input{ cursor:pointer; accent-color:#facc15; }

  .day30Banner{
    background:rgba(250,204,21,0.08);
    border:1px solid rgba(250,204,21,0.55);
    color:#facc15;
    border-radius:10px;
    padding:6px 10px;
    font-size:10px;
    text-align:center;
    letter-spacing:.08em;
  }

  .todayBanner {
    background:#0b1120;
    border:1px solid #1f2937;
    border-radius:10px;
    padding:8px 10px;
    margin:0 auto 6px auto;
    font-size:13px;
    max-width:700px;
    text-align:center;
  }
  .todayBanner-main { font-weight:600; }
  .todayBanner-sub { font-size:11px; color:#9ca3af; margin-top:2px; }

  .pillHighlight {
    display:inline-block;
    padding:1px 6px;
    border-radius:999px;
    background:rgba(250,204,21,0.2);
    border:1px solid rgba(250,204,21,0.7);
    color:#facc15;
    font-size:10px;
    text-transform:uppercase;
    letter-spacing:.08em;
  }

  .voiceRow {
    display:flex;
    justify-content:center;
    align-items:center;
    gap:8px;
    max-width:700px;
    margin:0 auto 6px auto;
  }

  /* ‚úÖ Speak button styles kept (harmless) in case you re-enable later, but button removed */
  .speak-btn {
    border-radius:999px;
    border:1px solid rgba(56,189,248,0.7);
    background:radial-gradient(circle at top,rgba(56,189,248,0.2) 0%,#020617 80%);
    color:#e0f2fe;
    font-size:11px;
    padding:5px 13px;
    cursor:pointer;
    display:inline-flex;
    align-items:center;
    gap:6px;
  }
  .speak-btn span.icon {
    width:9px;
    height:9px;
    border-radius:999px;
    background:#38bdf8;
    box-shadow:0 0 6px rgba(56,189,248,0.9);
  }
  .speak-btn:disabled {
    opacity:.45;
    cursor:not-allowed;
    border-style:dashed;
    box-shadow:none;
  }

  .share-btn {
    border-radius:999px;
    border:1px solid rgba(250,204,21,0.7);
    background:rgba(250,204,21,0.08);
    color:#facc15;
    font-size:10px;
    padding:5px 10px;
    cursor:pointer;
    display:inline-flex;
    align-items:center;
    gap:4px;
    white-space:nowrap;
  }
  .share-btn span.icon { font-size:11px; }

  .hedashRow {
    background:#020617;
    border-radius:8px;
    border:1px solid #111827;
    padding:8px;
    margin-bottom:8px;
    display:flex;
    align-items:center;
    justify-content:center;
    gap:8px;
  }
  .hedashIcon { font-size:24px; }
  .hedashText-main { font-size:12px; font-weight:600; }
  .hedashText-sub { font-size:10px; color:#9ca3af; }

  .weekRow {
    display:flex;
    align-items:center;
    gap:4px;
    margin:6px 0;
    background:#020617;
    padding:4px 6px;
    border-radius:8px;
    border:1px solid #111827;
  }

  .highlight-week {
    background:linear-gradient(90deg, rgba(250,204,21,0.12), #020617);
    border-color:rgba(250,204,21,0.55);
    box-shadow:0 0 0 1px rgba(250,204,21,0.2);
  }

  .weekLabel {
    width:60px;
    font-size:10px;
    text-transform:uppercase;
    letter-spacing:.12em;
    color:#9ca3af;
    text-align:center;
  }

  .phaseIcon { width:26px; text-align:center; font-size:18px; }

  .dayRow { display:flex; flex:1; gap:3px; }

  .dayBox {
    flex:1;
    background:#111827;
    border-radius:6px;
    padding:4px 1px;
    border:1px solid #1f2937;
    font-size:10px;
    text-align:center;
    display:flex;
    flex-direction:column;
    gap:1px;
  }

  .dayLabel { font-weight:500; font-size:10px; }
  .daySub { font-size:9px; color:#9ca3af; }

  .shabat {
    background:#1e293b;
    border-color:#facc15;
    color:#facc15;
    font-weight:600;
  }

  .day30 {
    background:rgba(250,204,21,0.10);
    border-color:rgba(250,204,21,0.65);
  }
  .day30 .dayLabel{ color:#facc15; font-weight:700; }
  .day30 .daySub{ color:#fde68a; }

  .highlight-day {
    background:rgba(250,204,21,0.25);
    border-color:rgba(250,204,21,0.85);
    box-shadow:0 0 0 1px rgba(250,204,21,0.35);
  }
  .highlight-day .dayLabel { color:#fef9c3; }
  .highlight-day .daySub { color:#fef3c7; }

  /* =========================================================
     ‚úÖ ABAYAB DAY 1 (HEDASH) SPOTLIGHT
     - Only affects the BIG TODAY banner + Day 1 Hedash row
     - Does NOT touch Shabat boxes
     ========================================================= */
  #todayBanner.abayab-on{
    border:2px solid #f59e0b !important;
    background:rgba(245,158,11,0.10) !important;
    box-shadow:
      0 0 0 1px rgba(245,158,11,.45) inset,
      0 0 26px rgba(245,158,11,.55),
      0 0 58px rgba(245,158,11,.35) !important;
  }
  #todayBanner.abayab-on .todayBanner-main,
  #todayBanner.abayab-on .todayBanner-sub,
  #todayBanner.abayab-on *{
    color:#f59e0b !important;
    text-shadow:0 0 14px rgba(245,158,11,.45) !important;
  }

  /* Make the Day 1 Hedash row also glow when ABAYAB Day 1 is active */
  #hedashRow.abayab-on{
    border:1px solid rgba(245,158,11,.65) !important;
    background:rgba(245,158,11,0.06) !important;
    box-shadow:
      0 0 0 1px rgba(245,158,11,.20) inset,
      0 0 18px rgba(245,158,11,.35) !important;
  }
  #hedashRow.abayab-on .hedashText-main,
  #hedashRow.abayab-on .hedashIcon{
    color:#f59e0b !important;
    text-shadow:0 0 12px rgba(245,158,11,.35) !important;
  }
  /* Keep sub text readable but still ‚ÄúAbayab orange-tinted‚Äù */
  #hedashRow.abayab-on .hedashText-sub{
    color:rgba(245,158,11,.85) !important;
  }
  /* Make the HEDASH pill orange only during ABAYAB Day 1 */
  #todayBanner.abayab-on .pillHighlight{
    background:rgba(245,158,11,0.18) !important;
    border-color:rgba(245,158,11,0.75) !important;
    color:#f59e0b !important;
    text-shadow:none !important;
  }

  .legendDetails { margin-top:8px; font-size:12px; }
  .legendDetails summary {
    cursor:pointer;
    list-style:none;
    padding:4px 8px;
    border-radius:999px;
    border:1px solid #1f2937;
    display:inline-block;
    font-size:11px;
    text-transform:uppercase;
    letter-spacing:.12em;
    color:#e5e7eb;
  }
  .legendDetails summary::-webkit-details-marker { display:none; }
  .legend { margin-top:8px; font-size:12px; text-align:center; }

  .legendRow {
    display:inline-flex;
    flex-wrap:wrap;
    gap:10px;
    align-items:center;
    margin-bottom:8px;
  }

  .legendColor {
    width:10px;
    height:10px;
    border-radius:3px;
    border:1px solid #1f2937;
  }

  .legendColor.work { background:#111827; }
  .legendColor.shabat { background:#1e293b; border-color:#facc15; }

  .phaseLegendTitle {
    font-size:10px;
    text-transform:uppercase;
    letter-spacing:.16em;
    color:#9ca3af;
    margin-bottom:3px;
    margin-top:3px;
  }

  .phaseLegendRow { display:flex; justify-content:space-between; gap:4px; }
  .phaseItem { flex:1; text-align:center; }
  .phaseItemIcon { font-size:20px; }
  .phaseItemText { font-size:10px; color:#9ca3af; }

  .calendarNoteBottom { margin-top:6px; font-size:10px; color:#9ca3af; }

  @media (max-width:640px){
    .calendarHeader { flex-direction:column; align-items:center; text-align:center; }
    .calendarSide { width:auto; white-space:normal; }
    .weekRow { padding:4px 3px; gap:3px; }
    .weekLabel { width:52px; font-size:9px; }
    .dayBox { font-size:9px; padding:4px 1px; }
    .dayLabel { font-size:9px; }
    .daySub { font-size:8px; }
    .phaseItemText { font-size:9px; }
  }
  </style>
</head>
<body>

<div class="calendar">
  <div class="calendarHeader">
    <div class="calendarSide calendarRef">YAHEZAQAL ‚Äî EZEKIEL 46:1</div>
    <div class="calendarTitle">THE KINGDOM CALENDAR</div>
    <div class="calendarSide" style="text-align:right;">
      <span class="monthBadge" id="month-badge">12th Month</span>
    </div>
  </div>

  <div class="calendarSub">Work Days &amp; Shabats According to the Path of Years</div>
  <div class="calendarNote">
    Shabats always fall on Days 8, 15, 22, and 29. Months may complete in 29 or 30 days; the cycle runs from Day 1 (HEDASH) through the last Shabat.
  </div>

  <div class="configBar">
    <span class="configLabel">Confirmed HEDASH Date (Gregorian):</span>
    <input type="date" id="hedash-input" />
    <span class="configLabel">Month:</span>
    <select id="month-select">
      <option value="1">1st ‚Äì Abayab</option>
      <option value="2">2nd Month</option>
      <option value="3">3rd Month</option>
      <option value="4">4th Month</option>
      <option value="5">5th Month</option>
      <option value="6">6th Month</option>
      <option value="7">7th Month</option>
      <option value="8">8th Month</option>
      <option value="9">9th Month</option>
      <option value="10">10th Month</option>
      <option value="11">11th Month</option>
      <option value="12" selected>12th Month</option>
    </select>
    <span class="configHint">(Set the Renewed Moon sighting date and which month this is.)</span>
  </div>

  <div class="monthTools">
    <div class="monthToggle">
      <span class="monthToggleLabel">Month Length:</span>
      <label class="monthRadio">
        <input type="radio" name="monthLength" value="29">
        <span>29 Days</span>
      </label>
      <label class="monthRadio">
        <input type="radio" name="monthLength" value="30">
        <span>30 Days</span>
      </label>
    </div>

    <div class="day30Banner" id="day30Banner" hidden>
      30-Day Month Active ‚Äî Day 30 is a waiting day. üåí HEDASH appears at evening to begin the next month when confirmed.
    </div>
  </div>

  <div class="hedashRow" id="hedashRow">
    <div class="hedashIcon">üåí</div>
    <div>
      <div class="hedashText-main">Day 1 ‚Äî HEDASH (Renewed Moon)</div>
      <div class="hedashText-sub">
        Sets the Shabat pattern for this month. The first full work week begins as the light grows toward üåì Half Moon Waxing.
      </div>
    </div>
  </div>

  <div class="todayBanner" id="todayBanner">
    <div class="todayBanner-main" id="today-main">
      Set the HEDASH date above to activate the Kingdom Calendar.
    </div>
    <div class="todayBanner-sub" id="today-sub">
      The tool will announce the current week, work day or Shabat, and day of YAHUAH‚ÄôS month according to the Path of Years.
    </div>
  </div>

  <!-- ‚úÖ VOICE REMOVED: Share button only -->
  <div class="voiceRow">
    <button type="button" class="share-btn" onclick="sharePage()">
      <span class="icon">üîó</span>
      Share This Page
    </button>
  </div>

  <div style="
    text-align:center;
    font-size:10px;
    color:#facc15;
    margin:0 auto 8px auto;
    background:rgba(250,204,21,0.08);
    border:1px solid rgba(250,204,21,0.45);
    padding:4px 6px;
    border-radius:6px;
    max-width:700px;
  ">
    The calendar changes over from evening to evening at <b>7:00 PM</b>, according to YAHUAH'S time.
  </div>

  <!-- WEEK 1 -->
  <div class="weekRow" data-week="1">
    <div class="weekLabel">1st Week</div>
    <div class="phaseIcon">üåí</div>
    <div class="dayRow">
      <div class="dayBox" data-day="2"><div class="dayLabel">Work Day 1</div><div class="daySub">Day 2</div></div>
      <div class="dayBox" data-day="3"><div class="dayLabel">Work Day 2</div><div class="daySub">Day 3</div></div>
      <div class="dayBox" data-day="4"><div class="dayLabel">Work Day 3</div><div class="daySub">Day 4</div></div>
      <div class="dayBox" data-day="5"><div class="dayLabel">Work Day 4</div><div class="daySub">Day 5</div></div>
      <div class="dayBox" data-day="6"><div class="dayLabel">Work Day 5</div><div class="daySub">Day 6</div></div>
      <div class="dayBox" data-day="7"><div class="dayLabel">Work Day 6</div><div class="daySub">Day 7</div></div>
      <div class="dayBox shabat" data-day="8" data-shabat-number="1"><div class="dayLabel">Shabat</div><div class="daySub">Day 8</div></div>
    </div>
    <div class="phaseIcon">üåì</div>
  </div>

  <!-- WEEK 2 -->
  <div class="weekRow" data-week="2">
    <div class="weekLabel">2nd Week</div>
    <div class="phaseIcon">üåì</div>
    <div class="dayRow">
      <div class="dayBox" data-day="9"><div class="dayLabel">Work Day 1</div><div class="daySub">Day 9</div></div>
      <div class="dayBox" data-day="10"><div class="dayLabel">Work Day 2</div><div class="daySub">Day 10</div></div>
      <div class="dayBox" data-day="11"><div class="dayLabel">Work Day 3</div><div class="daySub">Day 11</div></div>
      <div class="dayBox" data-day="12"><div class="dayLabel">Work Day 4</div><div class="daySub">Day 12</div></div>
      <div class="dayBox" data-day="13"><div class="dayLabel">Work Day 5</div><div class="daySub">Day 13</div></div>
      <div class="dayBox" data-day="14"><div class="dayLabel">Work Day 6</div><div class="daySub">Day 14</div></div>
      <div class="dayBox shabat" data-day="15" data-shabat-number="2"><div class="dayLabel">Shabat</div><div class="daySub">Day 15</div></div>
    </div>
    <div class="phaseIcon">üåï</div>
  </div>

  <!-- WEEK 3 -->
  <div class="weekRow" data-week="3">
    <div class="weekLabel">3rd Week</div>
    <div class="phaseIcon">üåï</div>
    <div class="dayRow">
      <div class="dayBox" data-day="16"><div class="dayLabel">Work Day 1</div><div class="daySub">Day 16</div></div>
      <div class="dayBox" data-day="17"><div class="dayLabel">Work Day 2</div><div class="daySub">Day 17</div></div>
      <div class="dayBox" data-day="18"><div class="dayLabel">Work Day 3</div><div class="daySub">Day 18</div></div>
      <div class="dayBox" data-day="19"><div class="dayLabel">Work Day 4</div><div class="daySub">Day 19</div></div>
      <div class="dayBox" data-day="20"><div class="dayLabel">Work Day 5</div><div class="daySub">Day 20</div></div>
      <div class="dayBox" data-day="21"><div class="dayLabel">Work Day 6</div><div class="daySub">Day 21</div></div>
      <div class="dayBox shabat" data-day="22" data-shabat-number="3"><div class="dayLabel">Shabat</div><div class="daySub">Day 22</div></div>
    </div>
    <div class="phaseIcon">üåó</div>
  </div>

  <!-- WEEK 4 -->
  <div class="weekRow" data-week="4">
    <div class="weekLabel">4th Week</div>
    <div class="phaseIcon">üåó</div>
    <div class="dayRow">
      <div class="dayBox" data-day="23"><div class="dayLabel">Work Day 1</div><div class="daySub">Day 23</div></div>
      <div class="dayBox" data-day="24"><div class="dayLabel">Work Day 2</div><div class="daySub">Day 24</div></div>
      <div class="dayBox" data-day="25"><div class="dayLabel">Work Day 3</div><div class="daySub">Day 25</div></div>
      <div class="dayBox" data-day="26"><div class="dayLabel">Work Day 4</div><div class="daySub">Day 26</div></div>
      <div class="dayBox" data-day="27"><div class="dayLabel">Work Day 5</div><div class="daySub">Day 27</div></div>
      <div class="dayBox" data-day="28"><div class="dayLabel">Work Day 6</div><div class="daySub">Day 28</div></div>
      <div class="dayBox shabat" data-day="29" data-shabat-number="4"><div class="dayLabel">Last Shabat</div><div class="daySub">Day 29</div></div>
    </div>
    <div class="phaseIcon">üåë</div>
  </div>

  <div class="weekRow" id="day30Row" style="display:none;">
    <div class="weekLabel">Day 30</div>
    <div class="phaseIcon">üåë</div>
    <div class="dayRow">
      <div class="dayBox day30" data-day="30" style="flex:1;">
        <div class="dayLabel">Waiting Day</div>
        <div class="daySub">Day 30 ‚Äî Dark Moon ‚Ä¢ üåí HEDASH appears at evening</div>
      </div>
    </div>
    <div class="phaseIcon">üåí</div>
  </div>

  <details class="legendDetails">
    <summary>Legend &amp; Notes</summary>
    <div class="legend">
      <div class="legendRow">
        <div class="legendColor work"></div><span>Work Day</span>
        <div class="legendColor shabat"></div><span>Shabat</span>
        <span>üåÖ Sunset Boundary ‚Äî Shabat from evening to evening</span>
      </div>

      <div class="phaseLegendTitle">Moon Phases &amp; Weeks</div>
      <div class="phaseLegendRow">
        <div class="phaseItem"><div class="phaseItemIcon">üåí</div><div class="phaseItemText">HEDASH ‚Äì Day 1</div></div>
        <div class="phaseItem"><div class="phaseItemIcon">üåì</div><div class="phaseItemText">Half Moon Waxing ‚Äì 1st Week</div></div>
        <div class="phaseItem"><div class="phaseItemIcon">üåï</div><div class="phaseItemText">Full Moon ‚Äì 2nd Week</div></div>
        <div class="phaseItem"><div class="phaseItemIcon">üåó</div><div class="phaseItemText">Half Moon Waning ‚Äì 3rd Week</div></div>
        <div class="phaseItem"><div class="phaseItemIcon">üåò</div><div class="phaseItemText">Waning Crescent ‚Äì 4th Week</div></div>
      </div>

      <div class="calendarNoteBottom">
        In a 29-day month HEDASH appears after the last Shabat (Day 29). In a 30-day month, Day 30 is a waiting day, and üåí HEDASH appears at evening when the next month begins (once confirmed).
      </div>
    </div>
  </details>

</div>

<script>
  const monthNameDisplay = {
    1: "YAHUAH‚ÄôS FIRST MONTH ‚Äî ABAYAB",
    2: "YAHUAH‚ÄôS SECOND MONTH",
    3: "YAHUAH‚ÄôS THIRD MONTH",
    4: "YAHUAH‚ÄôS FOURTH MONTH",
    5: "YAHUAH‚ÄôS FIFTH MONTH",
    6: "YAHUAH‚ÄôS SIXTH MONTH",
    7: "YAHUAH‚ÄôS SEVENTH MONTH",
    8: "YAHUAH‚ÄôS EIGHTH MONTH",
    9: "YAHUAH‚ÄôS NINTH MONTH",
    10:"YAHUAH‚ÄôS TENTH MONTH",
    11:"YAHUAH‚ÄôS ELEVENTH MONTH",
    12:"YAHUAH‚ÄôS TWELFTH MONTH"
  };

  const monthBadgeLabels = {
    1: "1st Month ‚Äî Abayab",
    2: "2nd Month",
    3: "3rd Month",
    4: "4th Month",
    5: "5th Month",
    6: "6th Month",
    7: "7th Month",
    8: "8th Month",
    9: "9th Month",
    10:"10th Month",
    11:"11th Month",
    12:"12th Month"
  };

  const ordinalWeekWords = { 1: "FIRST", 2: "SECOND", 3: "THIRD", 4: "FOURTH" };
  const ordinalShabatWords = { 1: "FIRST", 2: "SECOND", 3: "THIRD", 4: "FOURTH" };
  const ordinalDayWords = {
    1:"FIRST", 2:"SECOND", 3:"THIRD", 4:"FOURTH", 5:"FIFTH",
    6:"SIXTH", 7:"SEVENTH", 8:"EIGHTH", 9:"NINTH", 10:"TENTH",
    11:"ELEVENTH", 12:"TWELFTH", 13:"THIRTEENTH", 14:"FOURTEENTH",
    15:"FIFTEENTH", 16:"SIXTEENTH", 17:"SEVENTEENTH", 18:"EIGHTEENTH",
    19:"NINETEENTH", 20:"TWENTIETH", 21:"TWENTY-FIRST", 22:"TWENTY-SECOND",
    23:"TWENTY-THIRD", 24:"TWENTY-FOURTH", 25:"TWENTY-FIFTH", 26:"TWENTY-SIXTH",
    27:"TWENTY-SEVENTH", 28:"TWENTY-EIGHTH", 29:"TWENTY-NINTH", 30:"THIRTIETH"
  };

  const hedashInput  = document.getElementById("hedash-input");
  const monthSelect  = document.getElementById("month-select");
  const todayMain    = document.getElementById("today-main");
  const todaySub     = document.getElementById("today-sub");
  const monthBadgeEl = document.getElementById("month-badge");

  const day30Row    = document.getElementById("day30Row");
  const day30Banner = document.getElementById("day30Banner");

  const todayBannerEl = document.getElementById("todayBanner");
  const hedashRowEl   = document.getElementById("hedashRow");

  let monthLength = parseInt(localStorage.getItem("kc_monthLength") || "29", 10);
  if (monthLength !== 29 && monthLength !== 30) monthLength = 29;

  function syncMonthLengthUI(){
    document.querySelectorAll('input[name="monthLength"]').forEach(r => {
      r.checked = (parseInt(r.value, 10) === monthLength);
    });

    const show30 = (monthLength === 30);
    if (day30Row) day30Row.style.display = show30 ? "flex" : "none";
    if (day30Banner) day30Banner.hidden = !show30;
  }

  function bindMonthLengthToggle(){
    document.querySelectorAll('input[name="monthLength"]').forEach(radio => {
      radio.addEventListener("change", (e) => {
        monthLength = parseInt(e.target.value, 10);
        if (monthLength !== 29 && monthLength !== 30) monthLength = 29;
        localStorage.setItem("kc_monthLength", String(monthLength));
        syncMonthLengthUI();
        updateCalendar();
      });
    });
  }

  const savedHedash = localStorage.getItem("hedashDate");
  if (savedHedash) hedashInput.value = savedHedash;

  const savedMonth = localStorage.getItem("kingdomMonthNumber");
  if (savedMonth) monthSelect.value = savedMonth;

  function getCurrentMonthNumber() {
    const n = parseInt(monthSelect.value, 10);
    return (!isNaN(n) && n >= 1 && n <= 12) ? n : 12;
  }

  function updateMonthBadge() {
    const monthNum = getCurrentMonthNumber();
    monthBadgeEl.textContent = monthBadgeLabels[monthNum] || "Month";
  }
  updateMonthBadge();

  hedashInput.addEventListener("change", () => {
    if (hedashInput.value) localStorage.setItem("hedashDate", hedashInput.value);
    else localStorage.removeItem("hedashDate");
    updateCalendar();
  });

  monthSelect.addEventListener("change", () => {
    const monthNum = getCurrentMonthNumber();
    localStorage.setItem("kingdomMonthNumber", String(monthNum));
    updateMonthBadge();
    updateCalendar();
  });

  function clearHighlights() {
    document.querySelectorAll(".weekRow").forEach(row => row.classList.remove("highlight-week"));
    document.querySelectorAll(".dayBox").forEach(box => box.classList.remove("highlight-day"));
  }

  // ‚úÖ Voice disabled: keep this function so rest of code stays unchanged
  function setVoiceText(text) {
    // intentionally blank (voice removed for now)
  }

  function getKingdomToday() {
    const now  = new Date();
    const base = new Date(now.getFullYear(), now.getMonth(), now.getDate());
    if (now.getHours() >= 19) base.setDate(base.getDate() + 1);
    return base;
  }

  // ‚úÖ ABAYAB Day 1 spotlight toggle
  function setAbayabDay1Spotlight(on){
    if (todayBannerEl) todayBannerEl.classList.toggle("abayab-on", !!on);
    if (hedashRowEl) hedashRowEl.classList.toggle("abayab-on", !!on);
  }

  function updateCalendar() {
    clearHighlights();
    setVoiceText("");
    syncMonthLengthUI();

    // Always reset spotlight unless we explicitly turn it on
    setAbayabDay1Spotlight(false);

    const hedashValue  = hedashInput.value;
    const currentMonth = getCurrentMonthNumber();
    const monthName    = monthNameDisplay[currentMonth] || "YAHUAH‚ÄôS MONTH";

    if (!hedashValue) {
      todayMain.textContent = "Set the HEDASH date above to activate the Kingdom Calendar.";
      todaySub.textContent  = "The tool will announce the current week, work day or Shabat, and day of YAHUAH‚ÄôS month according to the Path of Years.";
      return;
    }

    const hedashDate = new Date(hedashValue + "T00:00:00");
    const hedashMid = new Date(hedashDate.getFullYear(), hedashDate.getMonth(), hedashDate.getDate());

    let kingdomToday = getKingdomToday();
    if (kingdomToday < hedashMid) kingdomToday = hedashMid;

    const diffMs     = kingdomToday - hedashMid;
    const dayOffset  = Math.floor(diffMs / (24*60*60*1000));
    const dayOfMonth = dayOffset + 1;

    if (dayOfMonth > monthLength) {
      todayMain.textContent = `TODAY IS BEYOND DAY ${monthLength} FROM THIS HEDASH ‚Äî CONFIRM THE NEXT HEDASH TO BEGIN ${monthName}.`;
      todaySub.textContent  = "Once the next Renewed Moon is confirmed, enter that date above to begin the new month.";
      return;
    }

    if (dayOfMonth === 1) {
      const mainText = `TODAY IS HEDASH ‚Äî THE RENEWED MOON ‚Äî DAY 1 OF ${monthName}, ACCORDING TO THE PATH OF YEARS.`;
      todayMain.textContent = mainText;
      todaySub.innerHTML = `<span class="pillHighlight">HEDASH</span> ‚Ä¢ The Renewed Moon sets the Shabats for ${monthName}.`;
      setVoiceText(mainText);

      // ‚úÖ ONLY ABAYAB gets the orange spotlight on Day 1
      if (currentMonth === 1) {
        setAbayabDay1Spotlight(true);
      }
      return;
    }

    if (dayOfMonth === 30) {
      const mainText = `TODAY IS DAY 30 ‚Äî A WAITING DAY ‚Äî DARK MOON CONCEALED ‚Äî AND üåí HEDASH APPEARS AT EVENING WHEN CONFIRMED TO BEGIN THE NEXT MONTH OF YAHUAH.`;
      todayMain.textContent = mainText;
      todaySub.innerHTML =
        `<span class="pillHighlight">Day 30</span>` +
        ` &nbsp;‚Ä¢&nbsp; <span class="pillHighlight">Waiting Day</span>` +
        ` &nbsp;‚Ä¢&nbsp; <span class="pillHighlight">HEDASH at Evening</span>`;
      const dayBox30 = document.querySelector(`.dayBox[data-day="30"]`);
      if (dayBox30) dayBox30.classList.add("highlight-day");
      setVoiceText(mainText);
      return;
    }

    const offsetFromDay2 = dayOfMonth - 2;
    const weekNumber     = Math.floor(offsetFromDay2 / 7) + 1;
    const positionInWeek = offsetFromDay2 % 7;
    const isShabat       = (positionInWeek === 6);

    const weekRow = document.querySelector(`.weekRow[data-week="${weekNumber}"]`);
    if (weekRow) weekRow.classList.add("highlight-week");

    const dayBox = document.querySelector(`.dayBox[data-day="${dayOfMonth}"]`);
    if (dayBox) dayBox.classList.add("highlight-day");

    const weekWord = ordinalWeekWords[weekNumber] || weekNumber.toString();
    const dayWord  = ordinalDayWords[dayOfMonth] || dayOfMonth.toString();

    let mainText = "";
    let subHtml  = "";

    if (isShabat) {
      const shabatBox = (dayBox && dayBox.getAttribute("data-shabat-number"))
        ? parseInt(dayBox.getAttribute("data-shabat-number"), 10)
        : null;

      const shabatWord = shabatBox
        ? (ordinalShabatWords[shabatBox] || shabatBox.toString())
        : "";

      mainText = `WE ARE IN THE ${weekWord} WEEK ‚Äî ON OUR ${shabatWord} SHABAT ‚Äî ON THE ${dayWord} DAY ‚Äî IN ${monthName.toUpperCase()} ‚Äî ACCORDING TO THE PATH OF YEARS.`;
      subHtml  =
        `<span class="pillHighlight">${weekWord} Week</span>` +
        ` &nbsp;‚Ä¢&nbsp; <span class="pillHighlight">${shabatWord} Shabat</span>` +
        ` &nbsp;‚Ä¢&nbsp; <span class="pillHighlight">${dayWord} Day</span>`;
    } else {
      const workDayNumber = positionInWeek + 1;
      const workDayWord   = ordinalDayWords[workDayNumber] || workDayNumber.toString();

      mainText = `WE ARE IN THE ${weekWord} WEEK ‚Äî ON THE ${workDayWord} WORK DAY ‚Äî ON THE ${dayWord} DAY ‚Äî IN ${monthName.toUpperCase()} ‚Äî ACCORDING TO THE PATH OF YEARS.`;
      subHtml  =
        `<span class="pillHighlight">${weekWord} Week</span>` +
        ` &nbsp;‚Ä¢&nbsp; <span class="pillHighlight">${workDayWord} Work Day</span>` +
        ` &nbsp;‚Ä¢&nbsp; <span class="pillHighlight">${dayWord} Day</span>`;
    }

    todayMain.textContent = mainText;
    todaySub.innerHTML    = subHtml;
    setVoiceText(mainText);
  }

  function sharePage() {
    if (navigator.share) {
      navigator.share({
        title: "Kingdom Calendar ‚Äì Path of Years",
        text: "Check out the Kingdom Calendar ‚Äì Path of Years tool!",
        url: "https://kingdomcalendartool.com/"
      }).catch((error) => console.log("Error sharing:", error));
    } else {
      alert("Sharing is not supported on this browser.");
    }
  }

  syncMonthLengthUI();
  bindMonthLengthToggle();

  function autoUpdateCalendar() {
    if (!hedashInput.value) return;
    updateCalendar();
  }

  updateCalendar();
  setInterval(autoUpdateCalendar, 60 * 1000);

  document.addEventListener("visibilitychange", () => {
    if (!document.hidden) autoUpdateCalendar();
  });
</script>

</body>
</html>
