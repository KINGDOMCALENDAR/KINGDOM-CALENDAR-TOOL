<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="icon" type="image/png" href="favicon.png">

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Kingdom Calendar â€“ Path of Years</title>

  <style>
  body {
    background:#020617;
    color:#e5e7eb;
    font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
    margin:0;
    padding:8px;
    display:flex;
    justify-content:center;
  }

  .calendar {
    width:100%;
    max-width:850px;
  }

  /* HEADER ROW */
  .calendarHeader {
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:8px;
    margin-bottom:2px;
  }

  .calendarSide {
    width:150px;
    font-size:10px;
    text-transform:uppercase;
    letter-spacing:.16em;
    color:#9ca3af;
    white-space:nowrap;
  }

  .calendarRef {
    text-align:left;
  }

  .calendarTitle {
    flex:1;
    text-align:center;
    font-size:18px;
    font-weight:600;
    letter-spacing:.18em;
    text-transform:uppercase;
    color:#fef9c3;
  }

  /* MONTH BADGE ON RIGHT */
  .monthBadge {
    display:inline-block;
    font-size:10px;
    text-transform:uppercase;
    letter-spacing:.18em;
    padding:3px 9px;
    border-radius:999px;
    background:rgba(250,204,21,0.18);
    border:1px solid rgba(250,204,21,0.7);
    color:#facc15;
  }

  /* SUBTEXT UNDER HEADER */
  .calendarSub {
    font-size:11px;
    color:#9ca3af;
    text-align:center;
    margin-bottom:2px;
  }
  .calendarNote {
    font-size:10px;
    color:#9ca3af;
    text-align:center;
    margin-bottom:6px;
  }

  /* CONFIG BAR */
  .configBar {
    background:#020617;
    border-radius:8px;
    border:1px solid #111827;
    padding:6px 8px;
    margin-bottom:8px;
    display:flex;
    flex-wrap:wrap;
    align-items:center;
    gap:6px;
    font-size:11px;
  }
  .configLabel {
    color:#e5e7eb;
  }
  .configBar input[type="date"],
  .configBar select {
    background:#020617;
    border:1px solid #1f2937;
    border-radius:6px;
    padding:3px 5px;
    color:#e5e7eb;
    font-size:11px;
  }
  .configHint {
    font-size:10px;
    color:#9ca3af;
  }

  /* TODAY BANNER */
  .todayBanner {
    background:#0b1120;
    border:1px solid #1f2937;
    border-radius:10px;
    padding:8px 10px;
    margin:0 auto 6px auto;
    font-size:13px;
    max-width:700px;
    text-align:center;
  }
  .todayBanner-main {
    font-weight:600;
  }
  .todayBanner-sub {
    font-size:11px;
    color:#9ca3af;
    margin-top:2px;
  }
  .pillHighlight {
    display:inline-block;
    padding:1px 6px;
    border-radius:999px;
    background:rgba(250,204,21,0.2);
    border:1px solid rgba(250,204,21,0.7);
    color:#facc15;
    font-size:10px;
    text-transform:uppercase;
    letter-spacing:.08em;
  }

  /* VOICE BUTTON ROW */
  .voiceRow {
    display:flex;
    justify-content:center;
    max-width:700px;
    margin:0 auto 8px auto;
  }
  .speak-btn {
    border-radius:999px;
    border:1px solid rgba(56,189,248,0.7);
    background:radial-gradient(circle at top,rgba(56,189,248,0.2) 0%,#020617 80%);
    color:#e0f2fe;
    font-size:11px;
    padding:5px 13px;
    cursor:pointer;
    display:inline-flex;
    align-items:center;
    gap:6px;
  }
  .speak-btn span.icon {
    width:9px;
    height:9px;
    border-radius:999px;
    background:#38bdf8;
    box-shadow:0 0 6px rgba(56,189,248,0.9);
  }
  .speak-btn:disabled {
    opacity:.45;
    cursor:not-allowed;
    border-style:dashed;
    box-shadow:none;
  }

  /* HEDASH ROW */
  .hedashRow {
    background:#020617;
    border-radius:8px;
    border:1px solid #111827;
    padding:8px;
    margin-bottom:8px;
    display:flex;
    align-items:center;
    justify-content:center;
    gap:8px;
  }
  .hedashIcon {
    font-size:24px;
  }
  .hedashText-main {
    font-size:12px;
    font-weight:600;
  }
  .hedashText-sub {
    font-size:10px;
    color:#9ca3af;
  }

  /* WEEK ROWS */
  .weekRow {
    display:flex;
    align-items:center;
    gap:4px;
    margin:6px 0;
    background:#020617;
    padding:4px 6px;
    border-radius:8px;
    border:1px solid #111827;
  }

  .highlight-week {
    background:linear-gradient(90deg, rgba(250,204,21,0.12), #020617);
    border-color:rgba(250,204,21,0.55);
    box-shadow:0 0 0 1px rgba(250,204,21,0.2);
  }

  .weekLabel {
    width:60px;
    font-size:10px;
    text-transform:uppercase;
    letter-spacing:.12em;
    color:#9ca3af;
    text-align:center;
  }

  .phaseIcon {
    width:26px;
    text-align:center;
    font-size:18px;
  }

  .dayRow {
    display:flex;
    flex:1;
    gap:3px;
  }

  .dayBox {
    flex:1;
    background:#111827;
    border-radius:6px;
    padding:4px 1px;
    border:1px solid #1f2937;
    font-size:10px;
    text-align:center;
    display:flex;
    flex-direction:column;
    gap:1px;
  }

  .dayLabel {
    font-weight:500;
    font-size:10px;
  }
  .daySub {
    font-size:9px;
    color:#9ca3af;
  }

  .shabat {
    background:#1e293b;
    border-color:#facc15;
    color:#facc15;
    font-weight:600;
  }

  .highlight-day {
    background:rgba(250,204,21,0.25);
    border-color:rgba(250,204,21,0.85);
    box-shadow:0 0 0 1px rgba(250,204,21,0.35);
  }
  .highlight-day .dayLabel {
    color:#fef9c3;
  }
  .highlight-day .daySub {
    color:#fef3c7;
  }

  /* MOBILE */
  @media (max-width:640px){
    .calendarHeader {
      flex-direction:column;
      align-items:center;
      text-align:center;
    }
    .calendarSide {
      width:auto;
      white-space:normal;
    }
    .weekRow { padding:4px 3px; gap:3px; }
    .weekLabel { width:52px; font-size:9px; }
    .dayBox { font-size:9px; padding:4px 1px; }
    .dayLabel { font-size:9px; }
    .daySub { font-size:8px; }
  }
  </style>
</head>
<body>

<div class="calendar">

  <!-- HEADER -->
  <div class="calendarHeader">
    <div class="calendarSide calendarRef">YAHEZAQAL â€” EZEKIEL 46:1</div>
    <div class="calendarTitle">THE KINGDOM CALENDAR</div>
    <div class="calendarSide" style="text-align:right;">
      <span class="monthBadge" id="month-badge">12th Month</span>
    </div>
  </div>

  <div class="calendarSub">Work Days &amp; Shabats According to the Path of Years</div>
  <div class="calendarNote">
    Shabats always fall on Days 8, 15, 22, and 29. Months may complete in 29 or 30 days; the cycle runs from Day 1 (HEDASH) through the last Shabat.
  </div>

  <!-- CONFIG BAR -->
  <div class="configBar">
    <span class="configLabel">Confirmed HEDASH Date:</span>
    <input type="date" id="hedash-input" />

    <span class="configLabel">Kingdom Month:</span>
    <select id="month-select">
      <option value="1">ABAYAB (1st Month)</option>
      <option value="2">2nd Month</option>
      <option value="3">3rd Month</option>
      <option value="4">4th Month</option>
      <option value="5">5th Month</option>
      <option value="6">6th Month</option>
      <option value="7">7th Month</option>
      <option value="8">8th Month</option>
      <option value="9">9th Month</option>
      <option value="10">10th Month</option>
      <option value="11">11th Month</option>
      <option value="12" selected>12th Month</option>
    </select>

    <span class="configHint">(Set the Renewed Moon and select the current Kingdom Month.)</span>
  </div>

  <!-- HEDASH ROW -->
  <div class="hedashRow">
    <div class="hedashIcon">ðŸŒ’</div>
    <div>
      <div class="hedashText-main">Day 1 â€” HEDASH (Renewed Moon)</div>
      <div class="hedashText-sub">
        HEDASH sets the Shabats for this Kingdom Month according to the Path of Years.
      </div>
    </div>
  </div>

  <!-- TODAY BANNER -->
  <div class="todayBanner">
    <div class="todayBanner-main" id="today-main">
      Set the HEDASH date and Kingdom Month to activate the Kingdom Calendar.
    </div>
    <div class="todayBanner-sub" id="today-sub">
      The tool will announce the current week, work day or Shabat, and day of YAHUAHâ€™S month according to the Path of Years.
    </div>
  </div>

  <!-- VOICE BUTTON -->
  <div class="voiceRow">
    <button id="speakBtn" type="button" class="speak-btn" disabled>
      <span class="icon"></span>
      Play Voice Announcement
    </button>
  </div>

  <!-- WEEK 1 -->
  <div class="weekRow" data-week="1">
    <div class="weekLabel">1st Week</div>
    <div class="phaseIcon">ðŸŒ“</div>
    <div class="dayRow">
      <div class="dayBox" data-day="2"><div class="dayLabel">Work Day 1</div><div class="daySub">Day 2</div></div>
      <div class="dayBox" data-day="3"><div class="dayLabel">Work Day 2</div><div class="daySub">Day 3</div></div>
      <div class="dayBox" data-day="4"><div class="dayLabel">Work Day 3</div><div class="daySub">Day 4</div></div>
      <div class="dayBox" data-day="5"><div class="dayLabel">Work Day 4</div><div class="daySub">Day 5</div></div>
      <div class="dayBox" data-day="6"><div class="dayLabel">Work Day 5</div><div class="daySub">Day 6</div></div>
      <div class="dayBox" data-day="7"><div class="dayLabel">Work Day 6</div><div class="daySub">Day 7</div></div>
      <div class="dayBox shabat" data-day="8" data-shabat-number="1"><div class="dayLabel">Shabat</div><div class="daySub">Day 8</div></div>
    </div>
    <div class="phaseIcon">ðŸŒ•</div>
  </div>

  <!-- WEEK 2 -->
  <div class="weekRow" data-week="2">
    <div class="weekLabel">2nd Week</div>
    <div class="phaseIcon">ðŸŒ•</div>
    <div class="dayRow">
      <div class="dayBox" data-day="9"><div class="dayLabel">Work Day 1</div><div class="daySub">Day 9</div></div>
      <div class="dayBox" data-day="10"><div class="dayLabel">Work Day 2</div><div class="daySub">Day 10</div></div>
      <div class="dayBox" data-day="11"><div class="dayLabel">Work Day 3</div><div class="daySub">Day 11</div></div>
      <div class="dayBox" data-day="12"><div class="dayLabel">Work Day 4</div><div class="daySub">Day 12</div></div>
      <div class="dayBox" data-day="13"><div class="dayLabel">Work Day 5</div><div class="daySub">Day 13</div></div>
      <div class="dayBox" data-day="14"><div class="dayLabel">Work Day 6</div><div class="daySub">Day 14</div></div>
      <div class="dayBox shabat" data-day="15" data-shabat-number="2"><div class="dayLabel">Shabat</div><div class="daySub">Day 15</div></div>
    </div>
    <div class="phaseIcon">ðŸŒ—</div>
  </div>

  <!-- WEEK 3 -->
  <div class="weekRow" data-week="3">
    <div class="weekLabel">3rd Week</div>
    <div class="phaseIcon">ðŸŒ—</div>
    <div class="dayRow">
      <div class="dayBox" data-day="16"><div class="dayLabel">Work Day 1</div><div class="daySub">Day 16</div></div>
      <div class="dayBox" data-day="17"><div class="dayLabel">Work Day 2</div><div class="daySub">Day 17</div></div>
      <div class="dayBox" data-day="18"><div class="dayLabel">Work Day 3</div><div class="daySub">Day 18</div></div>
      <div class="dayBox" data-day="19"><div class="dayLabel">Work Day 4</div><div class="daySub">Day 19</div></div>
      <div class="dayBox" data-day="20"><div class="dayLabel">Work Day 5</div><div class="daySub">Day 20</div></div>
      <div class="dayBox" data-day="21"><div class="dayLabel">Work Day 6</div><div class="daySub">Day 21</div></div>
      <div class="dayBox shabat" data-day="22" data-shabat-number="3"><div class="dayLabel">Shabat</div><div class="daySub">Day 22</div></div>
    </div>
    <div class="phaseIcon">ðŸŒ˜</div>
  </div>

  <!-- WEEK 4 -->
  <div class="weekRow" data-week="4">
    <div class="weekLabel">4th Week</div>
    <div class="phaseIcon">ðŸŒ˜</div>
    <div class="dayRow">
      <div class="dayBox" data-day="23"><div class="dayLabel">Work Day 1</div><div class="daySub">Day 23</div></div>
      <div class="dayBox" data-day="24"><div class="dayLabel">Work Day 2</div><div class="daySub">Day 24</div></div>
      <div class="dayBox" data-day="25"><div class="dayLabel">Work Day 3</div><div class="daySub">Day 25</div></div>
      <div class="dayBox" data-day="26"><div class="dayLabel">Work Day 4</div><div class="daySub">Day 26</div></div>
      <div class="dayBox" data-day="27"><div class="dayLabel">Work Day 5</div><div class="daySub">Day 27</div></div>
      <div class="dayBox" data-day="28"><div class="dayLabel">Work Day 6</div><div class="daySub">Day 28</div></div>
      <div class="dayBox shabat" data-day="29" data-shabat-number="4"><div class="dayLabel">Last Shabat</div><div class="daySub">Day 29</div></div>
    </div>
    <div class="phaseIcon">ðŸŒ‘</div>
  </div>

</div>

<script>
  // ---- Ordinal mappings ----
  const ordinalWeekWords = {1:"FIRST",2:"SECOND",3:"THIRD",4:"FOURTH"};
  const ordinalShabatWords = {1:"FIRST",2:"SECOND",3:"THIRD",4:"FOURTH"};
  const ordinalDayWords = {
    1:"FIRST", 2:"SECOND", 3:"THIRD", 4:"FOURTH", 5:"FIFTH",
    6:"SIXTH", 7:"SEVENTH", 8:"EIGHTH", 9:"NINTH", 10:"TENTH",
    11:"ELEVENTH", 12:"TWELFTH", 13:"THIRTEENTH", 14:"FOURTEENTH",
    15:"FIFTEENTH", 16:"SIXTEENTH", 17:"SEVENTEENTH", 18:"EIGHTEENTH",
    19:"NINETEENTH", 20:"TWENTIETH", 21:"TWENTY-FIRST", 22:"TWENTY-SECOND",
    23:"TWENTY-THIRD", 24:"TWENTY-FOURTH", 25:"TWENTY-FIFTH", 26:"TWENTY-SIXTH",
    27:"TWENTY-SEVENTH", 28:"TWENTY-EIGHTH", 29:"TWENTY-NINTH", 30:"THIRTIETH"
  };

  const hedashInput   = document.getElementById("hedash-input");
  const monthSelect   = document.getElementById("month-select");
  const monthBadge    = document.getElementById("month-badge");
  const todayMain     = document.getElementById("today-main");
  const todaySub      = document.getElementById("today-sub");
  const speakBtn      = document.getElementById("speakBtn");

  let lastVoiceText = "";
  let kingdomMonthIndex = 12; // default

  // --- Month label helpers ---
  function getMonthBadgeText(index){
    if(index === 1) return "ABAYAB";
    const suffix = (n) => {
      if (n === 1) return "st";
      if (n === 2) return "nd";
      if (n === 3) return "rd";
      return "th";
    };
    return `${index}${suffix(index)} Month`;
  }

  function toPhonetic(text){
  let t = text;
  t = t.replace(/YAHUAHâ€™S/gi,"YAH HOO WAHâ€™S");
  t = t.replace(/YAHUAH'S/gi,"YAH HOO WAH'S");
  t = t.replace(/YAHUAH/gi,"YAH HOO WAH");
  t = t.replace(/SHABAT/gi,"SHABOT");

  // Month 1 name: ABAYAB -> ABBAYOB (voice only)
  t = t.replace(/ABAYAB/gi,"ABBAYOB");

  return t;
}


  function updateMonthBadge(){
    monthBadge.textContent = getMonthBadgeText(kingdomMonthIndex);
  }

  // --- Phonetic for speech ---
  function toPhonetic(text){
    let t = text;
    t = t.replace(/YAHUAHâ€™S/gi,"YAH HOO WAHâ€™S");
    t = t.replace(/YAHUAH'S/gi,"YAH HOO WAH'S");
    t = t.replace(/YAHUAH/gi,"YAH HOO WAH");
    t = t.replace(/SHABAT/gi,"SHABOT");
    t = t.replace(/ABAYAB/gi,"ABBA YAAB");
    return t;
  }

  function clearHighlights(){
    document.querySelectorAll(".weekRow").forEach(r => r.classList.remove("highlight-week"));
    document.querySelectorAll(".dayBox").forEach(b => b.classList.remove("highlight-day"));
  }

  function setVoiceText(text){
    lastVoiceText = text || "";
    speakBtn.disabled = !lastVoiceText;
  }

  // --- Restore saved state (if browser supports it) ---
  try {
    const savedHedash = localStorage.getItem("hedashDate");
    const savedMonth  = localStorage.getItem("kingdomMonthIndex");
    if(savedHedash){
      hedashInput.value = savedHedash;
    }
    if(savedMonth){
      const val = parseInt(savedMonth,10);
      if(val >=1 && val <=12){
        kingdomMonthIndex = val;
        monthSelect.value = String(val);
      }
    }
  } catch(e) {
    // ignore if localStorage not available
  }

  updateMonthBadge();

  // --- Events ---
  hedashInput.addEventListener("change", () => {
    try { localStorage.setItem("hedashDate", hedashInput.value || ""); } catch(e){}
    updateCalendar();
  });

  monthSelect.addEventListener("change", () => {
    kingdomMonthIndex = parseInt(monthSelect.value,10) || 1;
    try { localStorage.setItem("kingdomMonthIndex", String(kingdomMonthIndex)); } catch(e){}
    updateMonthBadge();
    updateCalendar();
  });

  // --- Main calc ---
  function updateCalendar(){
    clearHighlights();
    setVoiceText("");

    const hedashValue = hedashInput.value;
    if(!hedashValue){
      todayMain.textContent = "Set the HEDASH date and Kingdom Month to activate the Kingdom Calendar.";
      todaySub.textContent  = "The tool will announce the correct week, work day or Shabat once HEDASH is set.";
      return;
    }

    const hedashDate = new Date(hedashValue + "T00:00:00");
    const now       = new Date();
    const hedashMid = new Date(hedashDate.getFullYear(), hedashDate.getMonth(), hedashDate.getDate());
    const todayMid  = new Date(now.getFullYear(), now.getMonth(), now.getDate());
    const diffMs    = todayMid - hedashMid;
    let dayOfMonth  = Math.floor(diffMs / (24*60*60*1000)) + 1;

    if(dayOfMonth < 1) dayOfMonth = 1;

    if(dayOfMonth > 30){
      todayMain.textContent = "Today is beyond the 30th day from the selected HEDASH.";
      todaySub.textContent  = "Confirm the next HEDASH to begin a new Kingdom Month.";
      return;
    }

    const monthVoice = getMonthVoiceText(kingdomMonthIndex);

    if(dayOfMonth === 1){
      const mainText =
        `TODAY IS HEDASH â€” THE RENEWED MOON â€” DAY 1 OF YAHUAHâ€™S ${monthVoice}, ACCORDING TO THE PATH OF YEARS.`;
      todayMain.textContent = mainText;
      todaySub.innerHTML =
        `<span class="pillHighlight">HEDASH</span> â€¢ The Renewed Moon sets the Shabats for this month according to the Path of Years.`;
      setVoiceText(mainText);
      return;
    }

    const offsetFromDay2 = dayOfMonth - 2;
    const weekNumber     = Math.floor(offsetFromDay2 / 7) + 1;
    const positionInWeek = offsetFromDay2 % 7;
    const isShabat       = (positionInWeek === 6);

    const weekRow = document.querySelector(`.weekRow[data-week="${weekNumber}"]`);
    if(weekRow){ weekRow.classList.add("highlight-week"); }

    const dayBox = document.querySelector(`.dayBox[data-day="${dayOfMonth}"]`);
    if(dayBox){ dayBox.classList.add("highlight-day"); }

    const weekWord = ordinalWeekWords[weekNumber] || String(weekNumber);
    const dayWord  = ordinalDayWords[dayOfMonth] || String(dayOfMonth);

    let mainText = "";
    let subHtml  = "";

    if(isShabat){
      const shNum  = dayBox && dayBox.getAttribute("data-shabat-number")
        ? parseInt(dayBox.getAttribute("data-shabat-number"),10)
        : null;
      const shWord = shNum ? (ordinalShabatWords[shNum] || String(shNum)) : "SHABAT";

      mainText =
        `WE ARE IN THE ${weekWord} WEEK â€” ON OUR ${shWord} SHABAT â€” ` +
        `ON THE ${dayWord} DAY â€” IN YAHUAHâ€™S ${monthVoice} â€” ACCORDING TO THE PATH OF YEARS.`;

      subHtml =
        `<span class="pillHighlight">${weekWord} Week</span>` +
        ` &nbsp;â€¢&nbsp; <span class="pillHighlight">${shWord} Shabat</span>` +
        ` &nbsp;â€¢&nbsp; <span class="pillHighlight">${dayWord} Day</span>`;
    } else {
      const workDayNumber = positionInWeek + 1;
      const workWord      = ordinalDayWords[workDayNumber] || String(workDayNumber);

      mainText =
        `WE ARE IN THE ${weekWord} WEEK â€” ON THE ${workWord} WORK DAY â€” ` +
        `ON THE ${dayWord} DAY â€” IN YAHUAHâ€™S ${monthVoice} â€” ACCORDING TO THE PATH OF YEARS.`;

      subHtml =
        `<span class="pillHighlight">${weekWord} Week</span>` +
        ` &nbsp;â€¢&nbsp; <span class="pillHighlight">${workWord} Work Day</span>` +
        ` &nbsp;â€¢&nbsp; <span class="pillHighlight">${dayWord} Day</span>`;
    }

    todayMain.textContent = mainText;
    todaySub.innerHTML    = subHtml;
    setVoiceText(mainText);
  }

  // Voice
  speakBtn.addEventListener("click", () => {
    if(!lastVoiceText) return;
    if(!("speechSynthesis" in window)){
      alert("Voice announcement is not available on this device or browser.");
      return;
    }

    window.speechSynthesis.cancel();
    const phoneticText = toPhonetic(lastVoiceText);
    const parts = phoneticText.split(" â€” ").map(p => p.trim()).filter(Boolean);

    let index = 0;
    function speakNext(){
      if(index >= parts.length) return;
      const u = new SpeechSynthesisUtterance(parts[index]);
      u.rate  = 0.9;
      u.pitch = 0.95;
      u.lang  = "en-US";
      u.onend = () => { index++; setTimeout(speakNext,200); };
      window.speechSynthesis.speak(u);
    }
    speakNext();
  });

  // Initial
  updateCalendar();
</script>

</body>
</html>
